<!DOCTYPE html> 
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-C85P61SPWR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-C85P61SPWR');
</script><script>const t = localStorage.getItem('bulma-theme'); if (t !== null) { document.documentElement.setAttribute('data-theme', t); } </script><meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="msapplication-TileColor" content="#0969e6">
  <meta name="theme-color" content="#0969e6"><title>最大概似估計 (Maximum Likelihood Estimation, MLE) | 邱秉誠 (BingCheng)</title>
  <meta property="og:title" content="最大概似估計 (Maximum Likelihood Estimation, MLE) - 邱秉誠 (BingCheng)">
  <meta property="og:type" content="article">
  
  <meta property="article:published_time" content=" 2021-03-01T00:00:00&#43;08:00">
  
  
  <meta property="article:modified_time" content=" 2021-03-01T00:00:00&#43;08:00">
  
  <meta name="keywords" content="Blog">
  <meta name="description" content="最大概似估計 (Maximum Likelihood Estimation, MLE)"><meta name="author" content="Bingcheng">
  <link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="32x32">
  <link rel="icon" href="/icon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="stylesheet" type="text/css" href="/css/bulma.min.css">
  <link rel="stylesheet" type="text/css" href="/css/hulga.min.css">
  <link rel="manifest" href="/manifest.json">
</head><body>
  <div id="main"><section class="hero is-primary shadow-hero ">
  <div class="hero-head">
    <nav class="navbar is-primary" role="navigation" aria-label="dropdown navigation">
  <div class="container">
    <div class="navbar-brand"><a class="navbar-item " href="/">
        邱秉誠 (BingCheng)
      </a>
      <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>
    <div class="navbar-menu" id="navMenu">
      <div class="navbar-end"><div class="navbar-item has-dropdown is-hoverable">
  <a class="navbar-link" href="#">
    <svg
    xmlns="http://www.w3.org/2000/svg"
    width="1em" height="1em"
    fill="currentColor"
    viewBox="0 0 32 32"
    >
    <path d="M16 .5C7.4.5.5 7.4.5 16S7.4 31.5 16 31.5 31.5 24.6 31.5 16 24.6.5 16 .5zm0 28.1V3.4C23 3.4 28.6 9 28.6 16S23 28.6 16 28.6z" />
  </svg>
  </a>
  <div class="navbar-dropdown" id="navDropdown">
    <a class="navbar-item theme-toggle" data-value="light" href="#">
      <span class="ticon">
      <svg viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12a4 4 0 1 0 8 0a4 4 0 1 0-8 0m-5 0h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7l-.7.7m0 11.4l.7.7m-12.1-.7l-.7.7"></path></svg>
      </span>Light</a>
    <a class="navbar-item theme-toggle" data-value="dark" href="#">
      <span class="ticon">
      <svg viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3h.393a7.5 7.5 0 0 0 7.92 12.446A9 9 0 1 1 12 2.992z"></path></svg>
      </span>Dark</a>
    <a class="navbar-item theme-toggle" data-value="system" href="#">
      <span class="ticon">
      <svg viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1zm4 15h10m-8-4v4m6-4v4"></path></svg>
      </span>System</a>
  </div>
</div>

        <a class="navbar-item" href="/" title="index">Home</a>
      
        <a class="navbar-item" href="/archives/" title="archives">Archives</a>
      
        <a class="navbar-item" href="/about/" title="about">About</a>
      
        <a class="navbar-item" href="/search/" title="search">Search</a>
      
      </div>
    </div>
  </div>
</nav>

  </div>
  <div class="hero-body">
    <header class="container has-text-centered" data-pagefind-body>
      <h1 class="title post-title is-spaced">
        最大概似估計 (Maximum Likelihood Estimation, MLE)
      </h1>
      <h2 class="subtitle"><time>2021/03/01</time> ・<span class="post-cat mr-2">
              <a href="/categories/%E8%B3%87%E6%96%99%E5%88%86%E6%9E%90/">資料分析</a>
            </span></h2>
      
      <div>
        <span class="post-tag mr-2 post-cat">
          <a href="/tags/%E7%B5%B1%E8%A8%88%E5%AD%B8/">#統計學</a>
        </span>
        <span class="post-tag mr-2 post-cat">
          <a href="/tags/python/">#Python</a>
        </span>
      </div>
      
    </header>
  </div>
</section>
<section class="section">
  <div class="container">
    <div class="columns">
      
      <div class="column is-7 is-offset-2">
      
        <article class="content" id="post-content" data-pagefind-body><p><strong>最大概似估計是一種估計模型參數的方法</strong>。適用時機在於手邊有模型，但是模型參數有無限多種，透過真實觀察到的樣本資訊，想辦法導出最有可能產生這些樣本結果的模型參數，也就是<strong>挑選使其概似性 (Likelihood) 最高的一組模型參數</strong>，這系列找參數的過程稱為最大概似估計法。</p>
<p>本文會以服從伯努利分布 (Bernoulli distribution)、常態分布 (Normal distribution) 的模型作為例子分別解說。至於相關程式碼則是放在文末。</p>
<p>本文的公式推導僅是化簡或者微分，但對於沒相關基礎的讀者可能較為吃力，公式推導個人認為可以選擇性閱讀，了解機率統計的概念比較重要。</p>
<h1 id="概似函數-likelihood-function">概似函數 (likelihood function)</h1>
<p>概似函數是一種關於統計模型中的母數的函數，<strong>函數值反映出統計模型輸出特定樣本值的可能性</strong>，換言之，<strong>如果找到特定的模型參數，使得概似函數值最大化，那就是該模型最合適的參數</strong>。</p>
<p>常見的概似函數有<strong>機率密度函數 (Probability density function)</strong>、<strong>機率質量函數 (Probability mass function)</strong> 等。是的，機率密度函數也是一種概似函數，當我們在談起常態分布的機率密度函數：</p>
<p>$$
f(x \mid \mu) = \frac{1}{\sqrt{2\pi\sigma^2}} e^{\displaystyle{-\frac{(x - \mu)^2}{2\sigma^2}}}
$$</p>
<p>將機率密度函數代入一個特定的樣本值 $a$，時常書寫為 $P(X=a)$，<strong>表示為該隨機變數X坐落在樣本值 $a$ 附近的可能性 (likelihood)</strong>，這裡的可能性不是樣本值發生的機率 (Probability)，因為連續變數在任何點取值都為 0。</p>
<p>至於機率質量函數，則是離散隨機變數，因此特定值的都有機率。我們會預測連續投擲 2 次硬幣為正面的機率是 0.25，我們也會說觀察到這 2 次硬幣為正面的可能性是 0.25，兩者都說得通。</p>
<p>概似性 (likelihood) 及機率 (probability) 兩者都表示事件的可能性，兩個甚至可以是一樣的東西，比如上述機率質量函數，但在數學上卻有截然不同的意涵，重新梳理如下。</p>
<p><strong>機率 (probability)，是指模型參數確定的條件下，用模型來預測接下來觀測的結果</strong>。比方用服從常態分佈的統計模型，來預測路人身高大於 170 的機率有多少。所以當我們在說機率，我們通常是以預測為目的。</p>
<p><strong>概似性 (likelihood)，則是已知某些觀測所得到的結果，對統計模型的可能性進行估計</strong>。比方實際觀察到路人的身高為170，透過機率密度函數計算出在這個統計模型下發生的可能性有多大。</p>
<p>以更新統計模型的流程檢視，統計模型會基於一組特定的參數推論或預測，某個值發生的機率，比如說硬幣正面的機率是 0.5，連續投擲兩次正面機率為 0.25，等到我實際收集到樣本資料，比如說擲好幾次硬幣，我們可以計算擲硬幣的結果在這個統計模型的概似性有多高，不同的模型參數會得到不同的概似性，<strong>最大概似估計就是選擇一組使其概似性最高的一組模型參數</strong>。</p>
<p>從上述的意義解讀，也可以想成是機率是『給定一組模型參數條件下，預測資料點發生的機率』；概似性則是『給定實際觀察到的樣本的條件下，這組模型參數產生這組樣本的可能性』，這當中是運用貝氏定理去進行條件機率的轉換。</p>
<p>$$
P(B|A) = \frac{P(A|B)P(B)}{P(A)}
$$</p>
<p>關於貝氏定理，可以閱讀這篇文章<a href="/post/bayes-theorem">貝氏定理</a>。</p>
<h1 id="伯努利分布-bernoulli-distribution">伯努利分布 (Bernoulli distribution)</h1>
<p>我們先從服從伯努利分布 (Bernoulli distribution) 的模型談起。</p>
<p>Bernoulli大概是世界上最簡單易懂的機率分布，它假設試驗只有成功或失敗兩種可能，如果成功的機率是 $θ$ ，那麼失敗的機率就是 $1-θ$ 。</p>
<p>考慮連續擲硬幣的例子，正面和反面可視作成功或失敗，因此每次的投擲都是一場獨立 Bernoulli trial，正面的機率是 $θ$；反面的機率$1-θ$。</p>
<p>假設今天連續投擲硬幣的結果為正面/反面的次數分別是 $H/T$，則投擲結果的機率質量函數為：</p>
<p>$$f(\theta,H,T) = \theta^H(1-\theta)^T $$</p>
<p>上述的機率質量函數的相乘就是概似函數 (likelihood function)，當實際觀察到 $H$ 次正面次數、$T$ 次反面次數的投擲結果，則在不同的模型參數 $θ$ 底下，產生出這組樣本結果的概似性。</p>
<p>假設今天連續投擲5次硬幣，很不湊巧地，這是一枚質地不均勻的硬幣，觀察到的投擲結果依序為4個正面、1個反面，我們以 0.1 為間距，枚舉9個可能的模型參數，藉由計算不同模型參數 $θ$ 底下，產生4個正面、1個反面這組樣本的概率為何。</p>
<p><strong>註</strong></p>
<p>如果不考慮投擲硬幣順序，只在乎&quot;成功的次數&quot;，那麼將會服從二項式分布 (Binomial distribution)，在此簡化處理，因此假設服從Bernoulli distribution。</p>
<p><img src="image.png" alt="alt text"></p>
<p>不難發現，上述的候選者中，0.8作為模型參數似乎是最合適的選擇，因為這組樣本是基於這個模型參數的概似性 (Likelihood) 最大。我們嘗試用程式模擬更多模型參數的概似性，可以得到大致的結果。(程式碼請見文末。)</p>
<p><img src="image-1.png" alt="alt text"></p>
<p>當然，我們不能每次都用窮舉的方式來找到最佳模型參數，何況上述只是為了舉例說明，實際上可能的模型參數是有無限多種，我們必須有一套更嚴謹的數學方法來實現。</p>
<p>投擲硬幣為正面的機率是 $θ$，在無限個 $θ$ 中，找到一個使概似性最大的 $θ$，其概似估計可以用以下數學式子：</p>
<p><img src="image-2.png" alt="alt text"></p>
<p>一個函式的極值往往坐落在斜率等於 $0$ 之處，因此將概似函數一次微分，計算等於 $0$ 時的值為何，最後得到 $H/(T+H)$ 的估計。</p>
<p><img src="image-3.png" alt="alt text"></p>
<p>因此，推導出來的模型參數符合直覺地，將投擲硬幣正面次數除以所有次數，就是每次投擲硬幣為正面的機率，想一想就感到十分奇妙，硬幣投擲結果為4個正面、1個反面，我們腦中的直覺就會告訴我們，投擲硬幣為正面的機率為 0.8，但從未想過，原來我們大腦觀察到數據、並建立一個模型，其背後的機制其實就是使用到最大概似估計！</p>
<h1 id="常態分布normal-distribution">常態分布(Normal distribution)</h1>
<p>基於常態分佈的模型同樣可以用最大概似估計法計算出最合適的模型參數。</p>
<p>假設我們知道國人身高的標準差為3公分，我們有30個國人身高的隨機樣本，要如何從樣本資訊反推出國人身高的平均呢？概念其實與硬幣例子如出一轍，只是在計算上比較繁瑣。</p>
<p>我們思考服從常態分配的模型是如何估計不同樣本結果的概似性。如果今天只有隨機抽取 2 個樣本，概率函數會是第一個樣本身高為 $x1$ 的機率密度 (通俗地說，就是任一國人在身高為 $x$ 的可能性)，再乘以第二樣本身高 $x2$ 的機率密度，至於為何變數之間可以直接相乘，是基於變數獨立的假設，因此公式可以推導如下：</p>
<p><img src="image-4.png" alt="alt text"></p>
<p>所以我們的任務就是要找到一個 $μ$，讓我將國人身高的樣本資訊代入時，使上面的概似函數值最大化。</p>
<p>Attention!
如果實際用上面的公式計算，一個小於1的值會連續相乘n次，你的程式很快就面臨到浮點數下溢 (floating point underflow) 問題，通俗來說，就是電腦受限硬體的限制，無法處理太多小數位的數值，以至於失去計算結果的精準度。(在小算盤計算0.5的30次方，大概就有感覺了。)</p>
<p>因此概似函數我們通常都會取 log 計算，因為 log 是單調遞增函數，我們可以確保函式取 log 之後，其以下式子仍然成立</p>
<p>因此概似函數取log重新表達如下</p>
<p>這時，我們就可以用程式模擬，分別以 <code>[160,161,162,163..180]</code>作為母體平均值 $μ$，來計算模型產生30個國人身高的機率為何，發現170 公分左右最吻合身高樣本的資訊。因此可以推斷母體 $μ$ 大致坐落在 170 左右。</p>
<p>註：因為實際的值很小，下圖是以相對機率表示。</p>
<p><img src="image-5.png" alt="alt text"></p>
<p>用程式模擬只是為了輔助說明，但實際上還是透過一次微分求極值，來幫助我們快速求得精準的答案。假設 $X$ 服從一個 $(μ ,σ²)$ 的常態分佈， $𝜇$ 是未知，概似函數剛剛已經整併成簡單的形式， 以下為數學推導：</p>
<p><img src="image-6.png" alt="alt text"></p>
<p>微分的結果告訴我們，樣本的平均值，其實就是母體平均值 $𝜇$ 最好的估計！又是一個相當符合直覺的答案！當然其他的最大概似估計就沒那麼直覺漂亮了。</p>
<h1 id="小結">小結</h1>
<p>最大概似估計是一種估計模型參數的方法。目的在透過真實觀察到的樣本資訊，找出最有可能產生這些樣本結果的模型參數。</p>
<p><strong>大致流程</strong></p>
<ol>
<li>找到合適概似函數估計，例如聯合機率密度函數、機率質量函數等。</li>
<li>概似函式數取log，並且進行一次微分求極值所在。</li>
</ol>
<p>本文不是容易書寫的題目，如果文中有疏漏之處，歡迎在底下留言指正~。</p></article>
      </div>
      
      <div class="column is-hidden-mobile">
        <div class="sidebar pl-4" id="toc">
          <div class="post post-toc" id="post-toc">
            
          </div>
        </div>
      </div>
      
    </div>
  </div>
</section>
  </div><script src="https://cdn.jsdelivr.net/npm/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>

<script src="http://localhost:1313/js/hulga.min.js" defer></script>

  
<link id="hlcss" rel="stylesheet" href="/css/friendly.min.css" type="text/css">
<script src="https://cdn.jsdelivr.net/npm/anchor-js@5.0.0/anchor.min.js"></script><script>
  anchors.options = {
    placement: 'left',
    
    icon: '#'
  };
  anchors.add('.content h1, .content h2, .content h3');
</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"
  integrity="sha384-5TcZemv2l/9On385z///+d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP" crossorigin="anonymous">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"
  integrity="sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6" crossorigin="anonymous"></script>


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"
  integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"
  onload="renderMathInElement(document.body);"></script><script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
        { left: "\\(", right: "\\)", display: false },
        { left: "\\[", right: "\\]", display: true }
      ],
      macros: {
        "\\displaystyle": "\\textstyle"
      },
      trust: true,
      throwOnError: false,
    });
  });
</script>

  


<link rel="stylesheet" type="text/css" href="http://localhost:1313/css/toc.min.css"><script src="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.js"></script>
<script>
    tocbot.init({
        
        tocSelector: '.post-toc',
        
        contentSelector: '#post-content',
        
        headingSelector: 'h1, h2, h3',
        collapseDepth:  6 ,
        scrollSmooth: true,
        positionFixedSelector: '.post-toc',
        
        
        fixedSidebarOffset: 273,
    });
</script>


</body>

</html>
