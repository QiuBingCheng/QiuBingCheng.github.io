<!DOCTYPE html> 
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-C85P61SPWR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-C85P61SPWR');
</script><script>const t = localStorage.getItem('bulma-theme'); if (t !== null) { document.documentElement.setAttribute('data-theme', t); } </script><meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="msapplication-TileColor" content="#0969e6">
  <meta name="theme-color" content="#0969e6"><title>中央極限定理 (Central Limit Theorem , CLT) | 邱秉誠 (BingCheng)</title>
  <meta property="og:title" content="中央極限定理 (Central Limit Theorem , CLT) - 邱秉誠 (BingCheng)">
  <meta property="og:type" content="article">
  
  <meta property="article:published_time" content=" 2021-02-27T00:00:00&#43;08:00">
  
  
  <meta property="article:modified_time" content=" 2021-02-27T00:00:00&#43;08:00">
  
  <meta name="keywords" content="Blog">
  <meta name="description" content="中央極限定理 (Central Limit Theorem , CLT)"><meta name="author" content="Bingcheng">
  <link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="32x32">
  <link rel="icon" href="/icon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="stylesheet" type="text/css" href="/css/bulma.min.css">
  <link rel="stylesheet" type="text/css" href="/css/hulga.min.css">
  <link rel="manifest" href="/manifest.json">
</head><body>
  <div id="main"><section class="hero is-primary shadow-hero ">
  <div class="hero-head">
    <nav class="navbar is-primary" role="navigation" aria-label="dropdown navigation">
  <div class="container">
    <div class="navbar-brand"><a class="navbar-item " href="/">
        邱秉誠 (BingCheng)
      </a>
      <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>
    <div class="navbar-menu" id="navMenu">
      <div class="navbar-end"><div class="navbar-item has-dropdown is-hoverable">
  <a class="navbar-link" href="#">
    <svg
    xmlns="http://www.w3.org/2000/svg"
    width="1em" height="1em"
    fill="currentColor"
    viewBox="0 0 32 32"
    >
    <path d="M16 .5C7.4.5.5 7.4.5 16S7.4 31.5 16 31.5 31.5 24.6 31.5 16 24.6.5 16 .5zm0 28.1V3.4C23 3.4 28.6 9 28.6 16S23 28.6 16 28.6z" />
  </svg>
  </a>
  <div class="navbar-dropdown" id="navDropdown">
    <a class="navbar-item theme-toggle" data-value="light" href="#">
      <span class="ticon">
      <svg viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12a4 4 0 1 0 8 0a4 4 0 1 0-8 0m-5 0h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7l-.7.7m0 11.4l.7.7m-12.1-.7l-.7.7"></path></svg>
      </span>Light</a>
    <a class="navbar-item theme-toggle" data-value="dark" href="#">
      <span class="ticon">
      <svg viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3h.393a7.5 7.5 0 0 0 7.92 12.446A9 9 0 1 1 12 2.992z"></path></svg>
      </span>Dark</a>
    <a class="navbar-item theme-toggle" data-value="system" href="#">
      <span class="ticon">
      <svg viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1zm4 15h10m-8-4v4m6-4v4"></path></svg>
      </span>System</a>
  </div>
</div>

        <a class="navbar-item" href="/" title="index">Home</a>
      
        <a class="navbar-item" href="/archives/" title="archives">Archives</a>
      
        <a class="navbar-item" href="/about/" title="about">About</a>
      
        <a class="navbar-item" href="/search/" title="search">Search</a>
      
      </div>
    </div>
  </div>
</nav>

  </div>
  <div class="hero-body">
    <header class="container has-text-centered" data-pagefind-body>
      <h1 class="title post-title is-spaced">
        中央極限定理 (Central Limit Theorem , CLT)
      </h1>
      <h2 class="subtitle"><time>2021/02/27</time> ・<span class="post-cat mr-2">
              <a href="/categories/%E8%B3%87%E6%96%99%E5%88%86%E6%9E%90/">資料分析</a>
            </span></h2>
      
      <div>
        <span class="post-tag mr-2 post-cat">
          <a href="/tags/%E7%B5%B1%E8%A8%88%E5%AD%B8/">#統計學</a>
        </span>
        <span class="post-tag mr-2 post-cat">
          <a href="/tags/python/">#Python</a>
        </span>
      </div>
      
    </header>
  </div>
</section>
<section class="section">
  <div class="container">
    <div class="columns">
      
      <div class="column is-7 is-offset-2">
      
        <article class="content" id="post-content" data-pagefind-body><p>中央極限定理是指，<strong>從任何母體隨機抽取大量獨立的隨機變數，其平均值會趨近於常態分佈</strong>。</p>
<p>提到常態分佈，讀者興許就明白為何該定理如此重要了。無論原始母體為何，當樣本數夠大，樣本平均數就會趨於常態分佈，便可以運用統計手法來驗證宣稱的樣本平均值是否合理，進一步幫助我們完成假設檢定的一系列流程。請參考 <a href="/post/hypothesis-test">假設檢定基礎觀念</a>。</p>
<h1 id="公式">公式</h1>
<p>假設母體的平均值為 $μ$，變異數為 $σ²$，從母體抽取隨機變數 $x_1, x_2, x_3..x_n$，這 $n$ 個隨機變數的平均值 ($\bar{X}$) 會服從常態分配。</p>
<p>一般而言，在針對常態分佈的假設檢定，我們都會將原始分數標準化，作法為將x減去母體平均 $μ$，再將兩者的差除以母體標準差 $σ$。以標準差做為單位來衡量原始分數與母體的真實距離，又稱為 z-score。</p>
<p>$$ Z=\frac{(X-\mu)} {\sigma} $$</p>
<p>這裡要注意的是，上述的 z-score 是原始的隨機亂數，但是如今是樣本的平均值 $\bar{X}$ 服從常態分佈，因此我們分別推導 $\bar{X}$ 的期望值與變異數。</p>
<p><strong>$\bar{X}$ 的期望值</strong></p>
<p>$$
\begin{aligned}
\mu_{\bar{X}} &amp;= E(\bar{X}) = E\left(\frac{x_1 + x_2 + x_3 + \cdots + x_n}{n} \right) \
&amp;= \frac{1}{n} \left( E(x_1) + E(x_2) + \cdots + E(x_n) \right) \
&amp;= \frac{1}{n} (n \mu) \
&amp;= \mu
\end{aligned}
$$</p>
<p>估計式的期望值等於母體參數，因此是不偏估計 (unbiased estimator)。</p>
<p><strong>$\bar{X}$ 的變異數</strong></p>
<p>$$
\begin{align*}
\sigma^2_{\bar{X}} &amp;= Var\left( \frac{x_1 + x_2 + x_3 + \cdots + x_n}{n} \right) \
&amp;= \frac{1}{n^2} Var(x_1 + x_2 + x_3 + \cdots + x_n) \
&amp;= \frac{1}{n^2} (n \sigma^2) \
&amp;= \frac{\sigma^2}{n}
\end{align*}
$$</p>
<p>經過上述推導，明白 $\bar{X}$ 會服從母體平均值為 $μ$、母體標準差為 $σ/\sqrt{n}$ 的常態分佈。因此 z-score 重新表示如下：</p>
<p>$$
Z = \frac{\bar{X} - \mu}{\frac{\sigma}{\sqrt{n}}}
$$</p>
<h1 id="模擬">模擬</h1>
<p>用隨機亂數的樣本平均值檢測分布的情形。</p>
<p>我們先隨意產生 $μ$ 為10、$σ$ 為 5 的高斯隨機變數作為母體，每次抽取10個樣本並計算平均值作為一個觀察值，如此抽取 1000 次，繪製成下方左上角的第一張圖，接著讓我們來試試看使用不同樣本大小，用以下程式依序使用 <code>[10,50,100,200]</code> 作為抽取的樣本大小並計算樣本平均值，如此各自抽取 1000次，最後使用 seanborn 的 displot 繪製圖形。</p>
<p>可以發現隨著樣本大小的增加，樣本平均越趨近於常態分布，並且變異數會越小，這是源於上述推導樣本平均數的標準差為 $σ/\sqrt{n}$。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">gaussian_population</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20000</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sample_size_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">sample_size</span> <span class="ow">in</span> <span class="n">sample_size_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">x_bar</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">gaussian_population</span><span class="p">,</span><span class="n">sample_size</span><span class="p">))</span><span class="o">/</span><span class="n">sample_size</span>
</span></span><span class="line"><span class="cl">        <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_bar</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span><span class="p">[</span><span class="n">sample_size</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">sample_size</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">displot</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">sample_size</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>在不同樣本大小，其樣本平均值的機率分佈</strong></p>
<p><img src="image-2.png" alt="alt text"></p>
<h1 id="舉例">舉例</h1>
<p>用中央極限定理的觀念來進行假設檢定。</p>
<p>假設乘客等候公車時間平均為 8.5 分鐘，標準差為 3.5 分鐘。假設今天隨機抽取 49 位乘客，平均候車的時間少於10鐘內的機率為何？</p>
<p>從題意上我們不知道真實乘客等候公車的時間是來自於何者分佈，但是由於今天抽取的樣本數目夠大(一般而言，樣本數量需要&gt;=30)，因此我們知道樣本的平均值會趨近常態分佈，將樣本平均值標準化，求得 z-score 如下：</p>
<p>$$
Z = \frac{\bar{X} - \mu}{\frac{\sigma}{\sqrt{n}}} =  \frac{10-8.5}{\frac{3.5}{\sqrt{49}}} = {\frac{1.5}{0.5}} = 3
$$</p>
<p>z-score 為3，意味 10 分鐘是樣本平均距離母體有三倍標準差，透過查表就可以得知 z-score 小於 3 倍標準差的面積為 0.9987，表示平均候車的時間少於10鐘內的機率為 0.9987。</p>
<p><img src="image.png" alt="alt text"></p>
<h1 id="小結">小結</h1>
<p>中央極限定理是指，<strong>從任何母體隨機抽取大量獨立的隨機變數，其平均值會趨近於常態分佈</strong>，當樣本數目夠大，越趨近於常態分佈，且變異數會越小。</p></article>
      </div>
      
      <div class="column is-hidden-mobile">
        <div class="sidebar pl-4" id="toc">
          <div class="post post-toc" id="post-toc">
            
          </div>
        </div>
      </div>
      
    </div>
  </div>
</section>
  </div><script src="https://cdn.jsdelivr.net/npm/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>

<script src="http://localhost:1313/js/hulga.min.js" defer></script>

  
<link id="hlcss" rel="stylesheet" href="/css/friendly.min.css" type="text/css">
<script src="https://cdn.jsdelivr.net/npm/anchor-js@5.0.0/anchor.min.js"></script><script>
  anchors.options = {
    placement: 'left',
    
    icon: '#'
  };
  anchors.add('.content h1, .content h2, .content h3');
</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script><script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      
      delimiters: [
        {left: "$$", right: "$$", display: true},
        {left: "$", right: "$", display: false},
        {left: "\\(", right: "\\)", display: false},
        {left: "\\[", right: "\\]", display: true}
      ]
    });
  });
</script>


  


<link rel="stylesheet" type="text/css" href="http://localhost:1313/css/toc.min.css"><script src="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.js"></script>
<script>
    tocbot.init({
        
        tocSelector: '.post-toc',
        
        contentSelector: '#post-content',
        
        headingSelector: 'h1, h2, h3',
        collapseDepth:  6 ,
        scrollSmooth: true,
        positionFixedSelector: '.post-toc',
        
        
        fixedSidebarOffset: 273,
    });
</script>


</body>

</html>
